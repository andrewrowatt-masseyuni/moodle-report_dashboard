!function(factory){if("function"==typeof define&&define.amd)define("report_dashboard/dataTables.buttons",["jquery","report_dashboard/dataTables"],(function($){return factory($,window,document)}));else if("object"==typeof exports){var jq=require("jquery"),cjsRequires=function(root,$){$.fn.dataTable||require("report_dashboard/dataTables")(root,$)};"undefined"==typeof window?module.exports=function(root,$){return root||(root=window),$||($=jq(root)),cjsRequires(root,$),factory($,root,root.document)}:(cjsRequires(window,jq),module.exports=factory(jq,window,window.document))}else factory(jQuery,window,document)}((function($,window,document){var DataTable=$.fn.dataTable,_instCounter=0,_buttonCounter=0,_dtButtons=DataTable.ext.buttons,_entityDecoder=null;function _fadeIn(el,duration,fn){$.fn.animate?el.stop().fadeIn(duration,fn):(el.css("display","block"),fn&&fn.call(el))}function _fadeOut(el,duration,fn){$.fn.animate?el.stop().fadeOut(duration,fn):(el.css("display","none"),fn&&fn.call(el))}var _infoTimer,Buttons=function(dt,config){if(!DataTable.versionCheck("2"))throw"Warning: Buttons requires DataTables 2 or newer";if(!(this instanceof Buttons))return function(settings){return new Buttons(settings,dt).container()};void 0===config&&(config={}),!0===config&&(config={}),Array.isArray(config)&&(config={buttons:config}),this.c=$.extend(!0,{},Buttons.defaults,config),config.buttons&&(this.c.buttons=config.buttons),this.s={dt:new DataTable.Api(dt),buttons:[],listenKeys:"",namespace:"dtb"+_instCounter++},this.dom={container:$("<"+this.c.dom.container.tag+"/>").addClass(this.c.dom.container.className)},this._constructor()};$.extend(Buttons.prototype,{action:function(node,action){var button=this._nodeToButton(node);return void 0===action?button.conf.action:(button.conf.action=action,this)},active:function(node,flag){var button=this._nodeToButton(node),klass=this.c.dom.button.active,jqNode=$(button.node);return button.inCollection&&this.c.dom.collection.button&&void 0!==this.c.dom.collection.button.active&&(klass=this.c.dom.collection.button.active),void 0===flag?jqNode.hasClass(klass):(jqNode.toggleClass(klass,void 0===flag||flag),this)},add:function(config,idx,draw){var buttons=this.s.buttons;if("string"==typeof idx){for(var split=idx.split("-"),base=this.s,i=0,ien=split.length-1;i<ien;i++)base=base.buttons[1*split[i]];buttons=base.buttons,idx=1*split[split.length-1]}let node=this._expandButton(buttons,config,void 0!==config?config.split:void 0,(void 0===config||void 0===config.split||0===config.split.length)&&void 0!==base,!1,idx);return void 0!==draw&&!0!==draw||this._draw(),node},collectionRebuild:function(node,newButtons){var button=this._nodeToButton(node);if(void 0!==newButtons){var i;for(i=button.buttons.length-1;i>=0;i--)this.remove(button.buttons[i].node);for(button.conf.prefixButtons&&newButtons.unshift.apply(newButtons,button.conf.prefixButtons),button.conf.postfixButtons&&newButtons.push.apply(newButtons,button.conf.postfixButtons),i=0;i<newButtons.length;i++){var newBtn=newButtons[i];this._expandButton(button.buttons,newBtn,void 0!==newBtn&&void 0!==newBtn.config&&void 0!==newBtn.config.split,!0,void 0!==newBtn.parentConf&&void 0!==newBtn.parentConf.split,null,newBtn.parentConf)}}this._draw(button.collection,button.buttons)},container:function(){return this.dom.container},disable:function(node){var button=this._nodeToButton(node);return button.isSplit?$(button.node.childNodes[0]).addClass(this.c.dom.button.disabled).prop("disabled",!0):$(button.node).addClass(this.c.dom.button.disabled).prop("disabled",!0),button.disabled=!0,this._checkSplitEnable(),this},destroy:function(){$("body").off("keyup."+this.s.namespace);var i,ien,buttons=this.s.buttons.slice();for(i=0,ien=buttons.length;i<ien;i++)this.remove(buttons[i].node);this.dom.container.remove();var buttonInsts=this.s.dt.settings()[0];for(i=0,ien=buttonInsts.length;i<ien;i++)if(buttonInsts.inst===this){buttonInsts.splice(i,1);break}return this},enable:function(node,flag){if(!1===flag)return this.disable(node);var button=this._nodeToButton(node);return button.isSplit?$(button.node.childNodes[0]).removeClass(this.c.dom.button.disabled).prop("disabled",!1):$(button.node).removeClass(this.c.dom.button.disabled).prop("disabled",!1),button.disabled=!1,this._checkSplitEnable(),this},index:function(node,nested,buttons){nested||(nested="",buttons=this.s.buttons);for(var i=0,ien=buttons.length;i<ien;i++){var inner=buttons[i].buttons;if(buttons[i].node===node)return nested+i;if(inner&&inner.length){var match=this.index(node,i+"-",inner);if(null!==match)return match}}return null},name:function(){return this.c.name},node:function(node){if(!node)return this.dom.container;var button=this._nodeToButton(node);return $(button.node)},processing:function(node,flag){var dt=this.s.dt,button=this._nodeToButton(node);return void 0===flag?$(button.node).hasClass("processing"):($(button.node).toggleClass("processing",flag),$(dt.table().node()).triggerHandler("buttons-processing.dt",[flag,dt.button(node),dt,$(node),button.conf]),this)},remove:function(node){var button=this._nodeToButton(node),host=this._nodeToHost(node),dt=this.s.dt;if(button.buttons.length)for(var i=button.buttons.length-1;i>=0;i--)this.remove(button.buttons[i].node);button.conf.destroying=!0,button.conf.destroy&&button.conf.destroy.call(dt.button(node),dt,$(node),button.conf),this._removeKey(button.conf),$(button.node).remove(),button.inserter&&$(button.inserter).remove();var idx=$.inArray(button,host);return host.splice(idx,1),this},text:function(node,label){var button=this._nodeToButton(node),textNode=button.textNode,dt=this.s.dt,jqNode=$(button.node),text=function(opt){return"function"==typeof opt?opt(dt,jqNode,button.conf):opt};return void 0===label?text(button.conf.text):(button.conf.text=label,textNode.html(text(label)),this)},_constructor:function(){var that=this,dt=this.s.dt,dtSettings=dt.settings()[0],buttons=this.c.buttons;dtSettings._buttons||(dtSettings._buttons=[]),dtSettings._buttons.push({inst:this,name:this.c.name});for(var i=0,ien=buttons.length;i<ien;i++)this.add(buttons[i]);dt.on("destroy",(function(e,settings){settings===dtSettings&&that.destroy()})),$("body").on("keyup."+this.s.namespace,(function(e){if(!document.activeElement||document.activeElement===document.body){var character=String.fromCharCode(e.keyCode).toLowerCase();-1!==that.s.listenKeys.toLowerCase().indexOf(character)&&that._keypress(character,e)}}))},_addKey:function(conf){conf.key&&(this.s.listenKeys+=$.isPlainObject(conf.key)?conf.key.key:conf.key)},_draw:function(container,buttons){container||(container=this.dom.container,buttons=this.s.buttons),container.children().detach();for(var i=0,ien=buttons.length;i<ien;i++)container.append(buttons[i].inserter),container.append(" "),buttons[i].buttons&&buttons[i].buttons.length&&this._draw(buttons[i].collection,buttons[i].buttons)},_expandButton:function(attachTo,button,split,inCollection,inSplit,attachPoint,parentConf){var lastButton,dt=this.s.dt,isSplit=!1,domCollection=this.c.dom.collection,buttons=Array.isArray(button)?button:[button];void 0===button&&(buttons=Array.isArray(split)?split:[split]);for(var i=0,ien=buttons.length;i<ien;i++){var conf=this._resolveExtends(buttons[i]);if(conf)if(isSplit=!(!conf.config||!conf.config.split),Array.isArray(conf))this._expandButton(attachTo,conf,void 0!==built&&void 0!==built.conf?built.conf.split:void 0,inCollection,void 0!==parentConf&&void 0!==parentConf.split,attachPoint,parentConf);else{var built=this._buildButton(conf,inCollection,void 0!==conf.split||void 0!==conf.config&&void 0!==conf.config.split,inSplit);if(built){if(null!=attachPoint?(attachTo.splice(attachPoint,0,built),attachPoint++):attachTo.push(built),built.conf.dropIcon&&!built.conf.split&&$(built.node).addClass(this.c.dom.button.dropClass).append(this.c.dom.button.dropHtml),built.conf.buttons&&(built.collection=$("<"+domCollection.container.content.tag+"/>"),built.conf._collection=built.collection,this._expandButton(built.buttons,built.conf.buttons,built.conf.split,!isSplit,isSplit,attachPoint,built.conf)),built.conf.split){built.collection=$("<"+domCollection.container.tag+"/>"),built.conf._collection=built.collection;for(var j=0;j<built.conf.split.length;j++){var item=built.conf.split[j];"object"==typeof item&&(item.parent=parentConf,void 0===item.collectionLayout&&(item.collectionLayout=built.conf.collectionLayout),void 0===item.dropup&&(item.dropup=built.conf.dropup),void 0===item.fade&&(item.fade=built.conf.fade))}this._expandButton(built.buttons,built.conf.buttons,built.conf.split,!isSplit,isSplit,attachPoint,built.conf)}built.conf.parent=parentConf,conf.init&&conf.init.call(dt.button(built.node),dt,$(built.node),conf),lastButton=built.node}}}return lastButton},_buildButton:function(config,inCollection,isSplit,inSplit){var textNode,button,that=this,configDom=this.c.dom,dt=this.s.dt,setLinerTab=!1,text=function(opt){return"function"==typeof opt?opt(dt,button,config):opt},dom=$.extend(!0,{},configDom.button);if(inCollection&&isSplit&&configDom.collection.split?$.extend(!0,dom,configDom.collection.split.action):inSplit||inCollection?$.extend(!0,dom,configDom.collection.button):isSplit&&$.extend(!0,dom,configDom.split.button),config.spacer){var spacer=$("<"+dom.spacer.tag+"/>").addClass("dt-button-spacer "+config.style+" "+dom.spacer.className).html(text(config.text));return{conf:config,node:spacer,nodeChild:null,inserter:spacer,buttons:[],inCollection:inCollection,isSplit:isSplit,collection:null,textNode:spacer}}if(config.available&&!config.available(dt,config)&&!config.html)return!1;if(config.html)button=$(config.html);else{var run=function(e,dt,button,config,done){config.action.call(dt.button(button),e,dt,button,config,done),$(dt.table().node()).triggerHandler("buttons-action.dt",[dt.button(button),dt,button,config])},action=function(e,dt,button,config){config.async?(that.processing(button[0],!0),setTimeout((function(){run(e,dt,button,config,(function(){that.processing(button[0],!1)}))}),config.async)):run(e,dt,button,config,(function(){}))},tag=config.tag||dom.tag,clickBlurs=void 0===config.clickBlurs||config.clickBlurs;if(button=$("<"+tag+"/>").addClass(dom.className).attr("aria-controls",this.s.dt.table().node().id).on("click.dtb",(function(e){e.preventDefault(),!button.hasClass(dom.disabled)&&config.action&&action(e,dt,button,config),clickBlurs&&button.trigger("blur")})).on("keypress.dtb",(function(e){13===e.keyCode&&(e.preventDefault(),!button.hasClass(dom.disabled)&&config.action&&action(e,dt,button,config))})),"a"===tag.toLowerCase()&&button.attr("href","#"),"button"===tag.toLowerCase()&&button.attr("type","button"),dom.liner.tag){var lc=dom.liner.tag.toLowerCase(),liner=$("<"+lc+"/>").html(text(config.text)).addClass(dom.liner.className);"a"===lc&&liner.attr("href","#"),"a"!==lc&&"button"!==lc||(liner.attr("tabindex",this.s.dt.settings()[0].iTabIndex),setLinerTab=!0),button.append(liner),textNode=liner}else button.html(text(config.text)),textNode=button;setLinerTab||button.attr("tabindex",this.s.dt.settings()[0].iTabIndex),!1===config.enabled&&button.addClass(dom.disabled),config.className&&button.addClass(config.className),config.titleAttr&&button.attr("title",text(config.titleAttr)),config.attr&&button.attr(config.attr),config.namespace||(config.namespace=".dt-button-"+_buttonCounter++),void 0!==config.config&&config.config.split&&(config.split=config.config.split)}var inserter,splitDiv,buttonContainer=this.c.dom.buttonContainer;if(inserter=buttonContainer&&buttonContainer.tag?$("<"+buttonContainer.tag+"/>").addClass(buttonContainer.className).append(button):button,this._addKey(config),this.c.buttonCreated&&(inserter=this.c.buttonCreated(config,inserter)),isSplit){var dropdownConf=inCollection?$.extend(!0,this.c.dom.split,this.c.dom.collection.split):this.c.dom.split,wrapperConf=dropdownConf.wrapper;splitDiv=$("<"+wrapperConf.tag+"/>").addClass(wrapperConf.className).append(button);var dropButtonConfig=$.extend(config,{autoClose:!0,align:dropdownConf.dropdown.align,attr:{"aria-haspopup":"dialog","aria-expanded":!1},className:dropdownConf.dropdown.className,closeButton:!1,splitAlignClass:dropdownConf.dropdown.splitAlignClass,text:dropdownConf.dropdown.text});this._addKey(dropButtonConfig);var splitAction=function(e,dt,button,config){_dtButtons.split.action.call(dt.button(splitDiv),e,dt,button,config),$(dt.table().node()).triggerHandler("buttons-action.dt",[dt.button(button),dt,button,config]),button.attr("aria-expanded",!0)},dropButton=$('<button class="'+dropdownConf.dropdown.className+' dt-button"></button>').html(this.c.dom.button.dropHtml).addClass(this.c.dom.button.dropClass).on("click.dtb",(function(e){e.preventDefault(),e.stopPropagation(),dropButton.hasClass(dom.disabled)||splitAction(e,dt,dropButton,dropButtonConfig),clickBlurs&&dropButton.trigger("blur")})).on("keypress.dtb",(function(e){13===e.keyCode&&(e.preventDefault(),dropButton.hasClass(dom.disabled)||splitAction(e,dt,dropButton,dropButtonConfig))}));0===config.split.length&&dropButton.addClass("dtb-hide-drop"),splitDiv.append(dropButton).attr(dropButtonConfig.attr)}var node=isSplit?splitDiv.get(0):button.get(0);return{conf:config,node:node,nodeChild:node&&node.children&&node.children.length?node.children[0]:null,inserter:isSplit?splitDiv:inserter,buttons:[],inCollection:inCollection,isSplit:isSplit,inSplit:inSplit,collection:null,textNode:textNode}},_checkSplitEnable:function(buttons){buttons||(buttons=this.s.buttons);for(var i=0;i<buttons.length;i++){var button=buttons[i];if(button.isSplit){var splitBtn=button.node.childNodes[1];this._checkAnyEnabled(button.buttons)?$(splitBtn).removeClass(this.c.dom.button.disabled).prop("disabled",!1):$(splitBtn).addClass(this.c.dom.button.disabled).prop("disabled",!1)}else button.isCollection&&this._checkSplitEnable(button.buttons)}},_checkAnyEnabled:function(buttons){for(var i=0;i<buttons.length;i++)if(!buttons[i].disabled)return!0;return!1},_nodeToButton:function(node,buttons){buttons||(buttons=this.s.buttons);for(var i=0,ien=buttons.length;i<ien;i++){if(buttons[i].node===node||buttons[i].nodeChild===node)return buttons[i];if(buttons[i].buttons.length){var ret=this._nodeToButton(node,buttons[i].buttons);if(ret)return ret}}},_nodeToHost:function(node,buttons){buttons||(buttons=this.s.buttons);for(var i=0,ien=buttons.length;i<ien;i++){if(buttons[i].node===node)return buttons;if(buttons[i].buttons.length){var ret=this._nodeToHost(node,buttons[i].buttons);if(ret)return ret}}},_keypress:function(character,e){if(!e._buttonsHandled){var run=function(conf,node){if(conf.key)if(conf.key===character)e._buttonsHandled=!0,$(node).click();else if($.isPlainObject(conf.key)){if(conf.key.key!==character)return;if(conf.key.shiftKey&&!e.shiftKey)return;if(conf.key.altKey&&!e.altKey)return;if(conf.key.ctrlKey&&!e.ctrlKey)return;if(conf.key.metaKey&&!e.metaKey)return;e._buttonsHandled=!0,$(node).click()}},recurse=function(a){for(var i=0,ien=a.length;i<ien;i++)run(a[i].conf,a[i].node),a[i].buttons.length&&recurse(a[i].buttons)};recurse(this.s.buttons)}},_removeKey:function(conf){if(conf.key){var character=$.isPlainObject(conf.key)?conf.key.key:conf.key,a=this.s.listenKeys.split(""),idx=$.inArray(character,a);a.splice(idx,1),this.s.listenKeys=a.join("")}},_resolveExtends:function(conf){var i,ien,that=this,dt=this.s.dt,toConfObject=function(base){for(var loop=0;!$.isPlainObject(base)&&!Array.isArray(base);){if(void 0===base)return;if("function"==typeof base){if(!(base=base.call(that,dt,conf)))return!1}else if("string"==typeof base){if(!_dtButtons[base])return{html:base};base=_dtButtons[base]}if(++loop>30)throw"Buttons: Too many iterations"}return Array.isArray(base)?base:$.extend({},base)};for(conf=toConfObject(conf);conf&&conf.extend;){if(!_dtButtons[conf.extend])throw"Cannot extend unknown button type: "+conf.extend;var objArray=toConfObject(_dtButtons[conf.extend]);if(Array.isArray(objArray))return objArray;if(!objArray)return!1;var originalClassName=objArray.className;void 0!==conf.config&&void 0!==objArray.config&&(conf.config=$.extend({},objArray.config,conf.config)),conf=$.extend({},objArray,conf),originalClassName&&conf.className!==originalClassName&&(conf.className=originalClassName+" "+conf.className),conf.extend=objArray.extend}var postfixButtons=conf.postfixButtons;if(postfixButtons)for(conf.buttons||(conf.buttons=[]),i=0,ien=postfixButtons.length;i<ien;i++)conf.buttons.push(postfixButtons[i]);var prefixButtons=conf.prefixButtons;if(prefixButtons)for(conf.buttons||(conf.buttons=[]),i=0,ien=prefixButtons.length;i<ien;i++)conf.buttons.splice(i,0,prefixButtons[i]);return conf},_popover:function(content,hostButton,inOpts){var dt=hostButton,c=this.c,closed=!1,options=$.extend({align:"button-left",autoClose:!1,background:!0,backgroundClassName:"dt-button-background",closeButton:!0,containerClassName:c.dom.collection.container.className,contentClassName:c.dom.collection.container.content.className,collectionLayout:"",collectionTitle:"",dropup:!1,fade:400,popoverTitle:"",rightAlignClassName:"dt-button-right",tag:c.dom.collection.container.tag},inOpts),containerSelector=options.tag+"."+options.containerClassName.replace(/ /g,"."),hostButtonNode=hostButton.node(),hostNode=options.collectionLayout.includes("fixed")?$("body"):hostButton.node(),close=function(){closed=!0,_fadeOut($(containerSelector),options.fade,(function(){$(this).detach()})),$(dt.buttons('[aria-haspopup="dialog"][aria-expanded="true"]').nodes()).attr("aria-expanded","false"),$("div.dt-button-background").off("click.dtb-collection"),Buttons.background(!1,options.backgroundClassName,options.fade,hostNode),$(window).off("resize.resize.dtb-collection"),$("body").off(".dtb-collection"),dt.off("buttons-action.b-internal"),dt.off("destroy.dtb-popover"),$("body").trigger("buttons-popover-hide.dt")};if(!1!==content){var existingExpanded=$(dt.buttons('[aria-haspopup="dialog"][aria-expanded="true"]').nodes());if(existingExpanded.length&&(hostNode.closest(containerSelector).length&&(hostNode=existingExpanded.eq(0)),close()),options.sort){var elements=$("button",content).map((function(idx,el){return{text:$(el).text(),el:el}})).toArray();elements.sort((function(a,b){return a.text.localeCompare(b.text)})),$(content).append(elements.map((function(v){return v.el})))}var cnt=$(".dt-button",content).length,mod="";3===cnt?mod="dtb-b3":2===cnt?mod="dtb-b2":1===cnt&&(mod="dtb-b1");var display=$("<"+options.tag+"/>").addClass(options.containerClassName).addClass(options.collectionLayout).addClass(options.splitAlignClass).addClass(mod).css("display","none").attr({"aria-modal":!0,role:"dialog"});content=$(content).addClass(options.contentClassName).attr("role","menu").appendTo(display),hostButtonNode.attr("aria-expanded","true"),hostNode.parents("body")[0]!==document.body&&(hostNode=$(document.body).children("div, section, p").last()),options.popoverTitle?display.prepend('<div class="dt-button-collection-title">'+options.popoverTitle+"</div>"):options.collectionTitle&&display.prepend('<div class="dt-button-collection-title">'+options.collectionTitle+"</div>"),options.closeButton&&display.prepend('<div class="dtb-popover-close">&times;</div>').addClass("dtb-collection-closeable"),_fadeIn(display.insertAfter(hostNode),options.fade);var tableContainer=$(hostButton.table().container()),position=display.css("position");if("container"!==options.span&&"dt-container"!==options.align||(hostNode=hostNode.parent(),display.css("width",tableContainer.width())),"absolute"===position){var offsetParent=$(hostNode[0].offsetParent),buttonPosition=hostNode.position(),buttonOffset=hostNode.offset(),tableSizes=offsetParent.offset(),containerPosition=offsetParent.position(),computed=window.getComputedStyle(offsetParent[0]);tableSizes.height=offsetParent.outerHeight(),tableSizes.width=offsetParent.width()+parseFloat(computed.paddingLeft),tableSizes.right=tableSizes.left+tableSizes.width,tableSizes.bottom=tableSizes.top+tableSizes.height;var top=buttonPosition.top+hostNode.outerHeight(),left=buttonPosition.left;display.css({top:top,left:left}),computed=window.getComputedStyle(display[0]);var popoverSizes=display.offset();popoverSizes.height=display.outerHeight(),popoverSizes.width=display.outerWidth(),popoverSizes.right=popoverSizes.left+popoverSizes.width,popoverSizes.bottom=popoverSizes.top+popoverSizes.height,popoverSizes.marginTop=parseFloat(computed.marginTop),popoverSizes.marginBottom=parseFloat(computed.marginBottom),options.dropup&&(top=buttonPosition.top-popoverSizes.height-popoverSizes.marginTop-popoverSizes.marginBottom),("button-right"===options.align||display.hasClass(options.rightAlignClassName))&&(left=buttonPosition.left-popoverSizes.width+hostNode.outerWidth()),"dt-container"!==options.align&&"container"!==options.align||left<buttonPosition.left&&(left=-buttonPosition.left),containerPosition.left+left+popoverSizes.width>$(window).width()&&(left=$(window).width()-popoverSizes.width-containerPosition.left),buttonOffset.left+left<0&&(left=-buttonOffset.left),containerPosition.top+top+popoverSizes.height>$(window).height()+$(window).scrollTop()&&(top=buttonPosition.top-popoverSizes.height-popoverSizes.marginTop-popoverSizes.marginBottom),offsetParent.offset().top+top<$(window).scrollTop()&&(top=buttonPosition.top+hostNode.outerHeight()),display.css({top:top,left:left})}else{var place=function(){var half=$(window).height()/2,top=display.height()/2;top>half&&(top=half),display.css("marginTop",-1*top)};place(),$(window).on("resize.dtb-collection",(function(){place()}))}options.background&&Buttons.background(!0,options.backgroundClassName,options.fade,options.backgroundHost||hostNode),$("div.dt-button-background").on("click.dtb-collection",(function(){})),options.autoClose&&setTimeout((function(){dt.on("buttons-action.b-internal",(function(e,btn,dt,node){node[0]!==hostNode[0]&&close()}))}),0),$(display).trigger("buttons-popover.dt"),dt.on("destroy.dtb-popover",close),setTimeout((function(){closed=!1,$("body").on("click.dtb-collection",(function(e){if(!closed){var back=$.fn.addBack?"addBack":"andSelf",parent=$(e.target).parent()[0];(!$(e.target).parents()[back]().filter(content).length&&!$(parent).hasClass("dt-buttons")||$(e.target).hasClass("dt-button-background"))&&close()}})).on("keyup.dtb-collection",(function(e){27===e.keyCode&&close()})).on("keydown.dtb-collection",(function(e){var elements=$("a, button",content),active=document.activeElement;9===e.keyCode&&(-1===elements.index(active)?(elements.first().focus(),e.preventDefault()):e.shiftKey?active===elements[0]&&(elements.last().focus(),e.preventDefault()):active===elements.last()[0]&&(elements.first().focus(),e.preventDefault()))}))}),0)}else close()}}),Buttons.background=function(show,className,fade,insertPoint){void 0===fade&&(fade=400),insertPoint||(insertPoint=document.body),show?_fadeIn($("<div/>").addClass(className).css("display","none").insertAfter(insertPoint),fade):_fadeOut($("div."+className),fade,(function(){$(this).removeClass(className).remove()}))},Buttons.instanceSelector=function(group,buttons){if(null==group)return $.map(buttons,(function(v){return v.inst}));var ret=[],names=$.map(buttons,(function(v){return v.name})),process=function(input){if(Array.isArray(input))for(var i=0,ien=input.length;i<ien;i++)process(input[i]);else if("string"==typeof input)if(-1!==input.indexOf(","))process(input.split(","));else{var idx=$.inArray(input.trim(),names);-1!==idx&&ret.push(buttons[idx].inst)}else if("number"==typeof input)ret.push(buttons[input].inst);else if("object"==typeof input&&input.nodeName)for(var j=0;j<buttons.length;j++)buttons[j].inst.dom.container[0]===input&&ret.push(buttons[j].inst);else"object"==typeof input&&ret.push(input)};return process(group),ret},Buttons.buttonSelector=function(insts,selector){for(var ret=[],nodeBuilder=function(a,buttons,baseIdx){for(var button,idx,i=0,ien=buttons.length;i<ien;i++)(button=buttons[i])&&(idx=void 0!==baseIdx?baseIdx+i:i+"",a.push({node:button.node,name:button.conf.name,idx:idx}),button.buttons&&nodeBuilder(a,button.buttons,idx+"-"))},run=function(selector,inst){var i,ien,buttons=[];nodeBuilder(buttons,inst.s.buttons);var nodes=$.map(buttons,(function(v){return v.node}));if(Array.isArray(selector)||selector instanceof $)for(i=0,ien=selector.length;i<ien;i++)run(selector[i],inst);else if(null==selector||"*"===selector)for(i=0,ien=buttons.length;i<ien;i++)ret.push({inst:inst,node:buttons[i].node});else if("number"==typeof selector)inst.s.buttons[selector]&&ret.push({inst:inst,node:inst.s.buttons[selector].node});else if("string"==typeof selector)if(-1!==selector.indexOf(",")){var a=selector.split(",");for(i=0,ien=a.length;i<ien;i++)run(a[i].trim(),inst)}else if(selector.match(/^\d+(\-\d+)*$/)){var indexes=$.map(buttons,(function(v){return v.idx}));ret.push({inst:inst,node:buttons[$.inArray(selector,indexes)].node})}else if(-1!==selector.indexOf(":name")){var name=selector.replace(":name","");for(i=0,ien=buttons.length;i<ien;i++)buttons[i].name===name&&ret.push({inst:inst,node:buttons[i].node})}else $(nodes).filter(selector).each((function(){ret.push({inst:inst,node:this})}));else if("object"==typeof selector&&selector.nodeName){var idx=$.inArray(selector,nodes);-1!==idx&&ret.push({inst:inst,node:nodes[idx]})}},i=0,ien=insts.length;i<ien;i++){var inst=insts[i];run(selector,inst)}return ret},Buttons.stripData=function(str,config){return null!==str&&"object"==typeof str&&str.nodeName&&str.nodeType&&(str=str.innerHTML),"string"!=typeof str||(str=Buttons.stripHtmlScript(str),str=Buttons.stripHtmlComments(str),config&&!config.stripHtml||(str=DataTable.util.stripHtml(str)),config&&!config.trim||(str=str.trim()),config&&!config.stripNewlines||(str=str.replace(/\n/g," ")),config&&!config.decodeEntities||(_entityDecoder?str=_entityDecoder(str):(_exportTextarea.innerHTML=str,str=_exportTextarea.value)),config&&!config.escapeExcelFormula||str.match(/^[=@\t\r]/)&&(str="'"+str)),str},Buttons.entityDecoder=function(fn){_entityDecoder=fn},Buttons.stripHtmlComments=function(input){var previous;do{previous=input,input=input.replace(/(<!--.*?--!?>)|(<!--[\S\s]+?--!?>)|(<!--[\S\s]*?$)/g,"")}while(input!==previous);return input},Buttons.stripHtmlScript=function(input){var previous;do{previous=input,input=input.replace(/<script\b[^<]*(?:(?!<\/script[^>]*>)<[^<]*)*<\/script[^>]*>/gi,"")}while(input!==previous);return input},Buttons.defaults={buttons:["copy","excel","csv","pdf","print"],name:"main",tabIndex:0,dom:{container:{tag:"div",className:"dt-buttons"},collection:{container:{className:"dt-button-collection",content:{className:"",tag:"div"},tag:"div"}},button:{tag:"button",className:"dt-button",active:"dt-button-active",disabled:"disabled",spacer:{className:"dt-button-spacer",tag:"span"},liner:{tag:"span",className:""},dropClass:"",dropHtml:'<span class="dt-button-down-arrow">&#x25BC;</span>'},split:{action:{className:"dt-button-split-drop-button dt-button",tag:"button"},dropdown:{align:"split-right",className:"dt-button-split-drop",splitAlignClass:"dt-button-split-left",tag:"button"},wrapper:{className:"dt-button-split",tag:"div"}}}},Buttons.version="3.2.6",$.extend(_dtButtons,{collection:{text:function(dt){return dt.i18n("buttons.collection","Collection")},className:"buttons-collection",closeButton:!1,dropIcon:!0,init:function(dt,button){button.attr("aria-expanded",!1)},action:function(e,dt,button,config){config._collection.parents("body").length?this.popover(!1,config):this.popover(config._collection,config),"keypress"===e.type&&$("a, button",config._collection).eq(0).focus()},attr:{"aria-haspopup":"dialog"}},split:{text:function(dt){return dt.i18n("buttons.split","Split")},className:"buttons-split",closeButton:!1,init:function(dt,button){return button.attr("aria-expanded",!1)},action:function(e,dt,button,config){this.popover(config._collection,config)},attr:{"aria-haspopup":"dialog"}},copy:function(){if(_dtButtons.copyHtml5)return"copyHtml5"},csv:function(dt,conf){if(_dtButtons.csvHtml5&&_dtButtons.csvHtml5.available(dt,conf))return"csvHtml5"},excel:function(dt,conf){if(_dtButtons.excelHtml5&&_dtButtons.excelHtml5.available(dt,conf))return"excelHtml5"},pdf:function(dt,conf){if(_dtButtons.pdfHtml5&&_dtButtons.pdfHtml5.available(dt,conf))return"pdfHtml5"},pageLength:function(dt){var lengthMenu=dt.settings()[0].aLengthMenu,vals=[],lang=[];if(Array.isArray(lengthMenu[0]))vals=lengthMenu[0],lang=lengthMenu[1];else for(var i=0;i<lengthMenu.length;i++){var option=lengthMenu[i];$.isPlainObject(option)?(vals.push(option.value),lang.push(option.label)):(vals.push(option),lang.push(option))}return{extend:"collection",text:function(dt){return dt.i18n("buttons.pageLength",{"-1":"Show all rows",_:"Show %d rows"},dt.page.len())},className:"buttons-page-length",autoClose:!0,buttons:$.map(vals,(function(val,i){return{text:lang[i],className:"button-page-length",action:function(e,dt){dt.page.len(val).draw()},init:function(dt,node,conf){var that=this,fn=function(){that.active(dt.page.len()===val)};dt.on("length.dt"+conf.namespace,fn),fn()},destroy:function(dt,node,conf){dt.off("length.dt"+conf.namespace)}}})),init:function(dt,node,conf){var that=this;dt.on("length.dt"+conf.namespace,(function(){that.text(conf.text)}))},destroy:function(dt,node,conf){dt.off("length.dt"+conf.namespace)}}},spacer:{style:"empty",spacer:!0,text:function(dt){return dt.i18n("buttons.spacer","")}}}),DataTable.Api.register("buttons()",(function(group,selector){void 0===selector&&(selector=group,group=void 0),this.selector.buttonGroup=group;var res=this.iterator(!0,"table",(function(ctx){if(ctx._buttons)return Buttons.buttonSelector(Buttons.instanceSelector(group,ctx._buttons),selector)}),!0);return res._groupSelector=group,res})),DataTable.Api.register("button()",(function(group,selector){var buttons=this.buttons(group,selector);return buttons.length>1&&buttons.splice(1,buttons.length),buttons})),DataTable.Api.registerPlural("buttons().active()","button().active()",(function(flag){return void 0===flag?this.map((function(set){return set.inst.active(set.node)})):this.each((function(set){set.inst.active(set.node,flag)}))})),DataTable.Api.registerPlural("buttons().action()","button().action()",(function(action){return void 0===action?this.map((function(set){return set.inst.action(set.node)})):this.each((function(set){set.inst.action(set.node,action)}))})),DataTable.Api.registerPlural("buttons().collectionRebuild()","button().collectionRebuild()",(function(buttons){return this.each((function(set){for(var i=0;i<buttons.length;i++)"object"==typeof buttons[i]&&(buttons[i].parentConf=set);set.inst.collectionRebuild(set.node,buttons)}))})),DataTable.Api.register(["buttons().enable()","button().enable()"],(function(flag){return this.each((function(set){set.inst.enable(set.node,flag)}))})),DataTable.Api.register(["buttons().disable()","button().disable()"],(function(){return this.each((function(set){set.inst.disable(set.node)}))})),DataTable.Api.register("button().index()",(function(){var idx=null;return this.each((function(set){var res=set.inst.index(set.node);null!==res&&(idx=res)})),idx})),DataTable.Api.registerPlural("buttons().nodes()","button().node()",(function(){var jq=$();return $(this.each((function(set){jq=jq.add(set.inst.node(set.node))}))),jq})),DataTable.Api.registerPlural("buttons().processing()","button().processing()",(function(flag){return void 0===flag?this.map((function(set){return set.inst.processing(set.node)})):this.each((function(set){set.inst.processing(set.node,flag)}))})),DataTable.Api.registerPlural("buttons().text()","button().text()",(function(label){return void 0===label?this.map((function(set){return set.inst.text(set.node)})):this.each((function(set){set.inst.text(set.node,label)}))})),DataTable.Api.registerPlural("buttons().trigger()","button().trigger()",(function(){return this.each((function(set){set.inst.node(set.node).trigger("click")}))})),DataTable.Api.register("button().popover()",(function(content,options){return this.map((function(set){return set.inst._popover(content,this.button(this[0].node),options)}))})),DataTable.Api.register("buttons().containers()",(function(){var jq=$(),groupSelector=this._groupSelector;return this.iterator(!0,"table",(function(ctx){if(ctx._buttons)for(var insts=Buttons.instanceSelector(groupSelector,ctx._buttons),i=0,ien=insts.length;i<ien;i++)jq=jq.add(insts[i].container())})),jq})),DataTable.Api.register("buttons().container()",(function(){return this.containers().eq(0)})),DataTable.Api.register("button().add()",(function(idx,conf,draw){var node,ctx=this.context;if(ctx.length){var inst=Buttons.instanceSelector(this._groupSelector,ctx[0]._buttons);inst.length&&(node=inst[0].add(conf,idx,draw))}return node?this.button(this._groupSelector,node):this})),DataTable.Api.register("buttons().destroy()",(function(){return this.pluck("inst").unique().each((function(inst){inst.destroy()})),this})),DataTable.Api.registerPlural("buttons().remove()","buttons().remove()",(function(){return this.each((function(set){set.inst.remove(set.node)})),this})),DataTable.Api.register("buttons.info()",(function(title,message,time){var that=this;return!1===title?(this.off("destroy.btn-info"),_fadeOut($("#datatables_buttons_info"),400,(function(){$(this).remove()})),clearTimeout(_infoTimer),_infoTimer=null,this):(_infoTimer&&clearTimeout(_infoTimer),$("#datatables_buttons_info").length&&$("#datatables_buttons_info").remove(),title=title?"<h2>"+title+"</h2>":"",_fadeIn($('<div id="datatables_buttons_info" class="dt-button-info"/>').html(title).append($("<div/>")["string"==typeof message?"html":"append"](message)).css("display","none").appendTo("body")),void 0!==time&&0!==time&&(_infoTimer=setTimeout((function(){that.buttons.info(!1)}),time)),this.on("destroy.btn-info",(function(){that.buttons.info(!1)})),this)})),DataTable.Api.register("buttons.exportData()",(function(options){if(this.context.length)return _exportData(new DataTable.Api(this.context[0]),options)})),DataTable.Api.register("buttons.exportInfo()",(function(conf){return conf||(conf={}),{filename:_filename(conf,this),title:_title(conf,this),messageTop:_message(this,conf,conf.message||conf.messageTop,"top"),messageBottom:_message(this,conf,conf.messageBottom,"bottom")}}));var _filename=function(config,dt){var filename="*"===config.filename&&"*"!==config.title&&void 0!==config.title&&null!==config.title&&""!==config.title?config.title:config.filename;if("function"==typeof filename&&(filename=filename(config,dt)),null==filename)return null;-1!==filename.indexOf("*")&&(filename=filename.replace(/\*/g,$("head > title").text()).trim()),filename=filename.replace(/[^a-zA-Z0-9_\u00A1-\uFFFF\.,\-_ !\(\)]/g,"");var extension=_stringOrFunction(config.extension,config,dt);return extension||(extension=""),filename+extension},_stringOrFunction=function(option,config,dt){return null==option?null:"function"==typeof option?option(config,dt):option},_title=function(config,dt){var title=_stringOrFunction(config.title,config,dt);return null===title?null:-1!==title.indexOf("*")?title.replace(/\*/g,$("head > title").text()||"Exported data"):title},_message=function(dt,config,option,position){var message=_stringOrFunction(option,config,dt);if(null===message)return null;var caption=$("caption",dt.table().container()).eq(0);return"*"===message?caption.css("caption-side")!==position?null:caption.length?caption.text():"":message},_exportTextarea=$("<textarea/>")[0],_exportData=function(dt,inOpts){var config=$.extend(!0,{},{rows:null,columns:"",modifier:{search:"applied",order:"applied"},orthogonal:"display",stripHtml:!0,stripNewlines:!0,decodeEntities:!0,escapeExcelFormula:!1,trim:!0,format:{header:function(d){return Buttons.stripData(d,config)},footer:function(d){return Buttons.stripData(d,config)},body:function(d){return Buttons.stripData(d,config)}},customizeData:null,customizeZip:null},inOpts),header=dt.columns(config.columns).indexes().map((function(idx){var col=dt.column(idx);return config.format.header(col.title(),idx,col.header())})).toArray(),footer=dt.table().footer()?dt.columns(config.columns).indexes().map((function(idx){var el=dt.column(idx).footer(),val="";if(el){var inner=$(".dt-column-title",el);val=inner.length?inner.html():$(el).html()}return config.format.footer(val,idx,el)})).toArray():null,modifier=$.extend({},config.modifier);dt.select&&"function"==typeof dt.select.info&&void 0===modifier.selected&&dt.rows(config.rows,$.extend({selected:!0},modifier)).any()&&$.extend(modifier,{selected:!0});for(var rowIndexes=dt.rows(config.rows,modifier).indexes().toArray(),selectedCells=dt.cells(rowIndexes,config.columns,{order:modifier.order}),cells=selectedCells.render(config.orthogonal).toArray(),cellNodes=selectedCells.nodes().toArray(),cellIndexes=selectedCells.indexes().toArray(),columns=dt.columns(config.columns).count(),body=[],cellCounter=0,i=0,ien=columns>0?cells.length/columns:0;i<ien;i++){for(var row=[columns],j=0;j<columns;j++)row[j]=config.format.body(cells[cellCounter],cellIndexes[cellCounter].row,cellIndexes[cellCounter].column,cellNodes[cellCounter]),cellCounter++;body[i]=row}var data={header:header,headerStructure:_headerFormatter(config.format.header,dt.table().header.structure(config.columns)),footer:footer,footerStructure:_headerFormatter(config.format.footer,dt.table().footer.structure(config.columns)),body:body};return config.customizeData&&config.customizeData(data),data};function _headerFormatter(formatter,struct){for(var i=0;i<struct.length;i++)for(var j=0;j<struct[i].length;j++){var item=struct[i][j];item&&(item.title=formatter(item.title,j,item.cell))}return struct}function _init(settings,options){var api=new DataTable.Api(settings),opts=options||(api.init().buttons||DataTable.defaults.buttons);return new Buttons(api,opts).container()}return $.fn.dataTable.Buttons=Buttons,$.fn.DataTable.Buttons=Buttons,$(document).on("init.dt plugin-init.dt",(function(e,settings){if("dt"===e.namespace){var opts=settings.oInit.buttons||DataTable.defaults.buttons;opts&&!settings._buttons&&new Buttons(settings,opts).container()}})),DataTable.ext.feature.push({fnInit:_init,cFeature:"B"}),DataTable.feature&&DataTable.feature.register("buttons",_init),DataTable}));

//# sourceMappingURL=dataTables.buttons.min.js.map