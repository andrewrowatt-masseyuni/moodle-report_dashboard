{"version":3,"file":"buttons.print.min.js","sources":["../src/buttons.print.js"],"sourcesContent":["/*!\n * Print button for Buttons and DataTables.\n * Â© SpryMedia Ltd - datatables.net/license\n */\n\n(function( factory ){\n\tif ( typeof define === 'function' && define.amd ) {\n\t\t// AMD\n\t\tdefine( ['jquery', 'report_dashboard/dataTables', 'datatables.net-buttons'], function ( $ ) {\n\t\t\treturn factory( $, window, document );\n\t\t} );\n\t}\n\telse if ( typeof exports === 'object' ) {\n\t\t// CommonJS\n\t\tvar jq = require('jquery');\n\t\tvar cjsRequires = function (root, $) {\n\t\t\tif ( ! $.fn.dataTable ) {\n\t\t\t\trequire('report_dashboard/dataTables')(root, $);\n\t\t\t}\n\n\t\t\tif ( ! $.fn.dataTable.Buttons ) {\n\t\t\t\trequire('datatables.net-buttons')(root, $);\n\t\t\t}\n\t\t};\n\n\t\tif (typeof window === 'undefined') {\n\t\t\tmodule.exports = function (root, $) {\n\t\t\t\tif ( ! root ) {\n\t\t\t\t\t// CommonJS environments without a window global must pass a\n\t\t\t\t\t// root. This will give an error otherwise\n\t\t\t\t\troot = window;\n\t\t\t\t}\n\n\t\t\t\tif ( ! $ ) {\n\t\t\t\t\t$ = jq( root );\n\t\t\t\t}\n\n\t\t\t\tcjsRequires( root, $ );\n\t\t\t\treturn factory( $, root, root.document );\n\t\t\t};\n\t\t}\n\t\telse {\n\t\t\tcjsRequires( window, jq );\n\t\t\tmodule.exports = factory( jq, window, window.document );\n\t\t}\n\t}\n\telse {\n\t\t// Browser\n\t\tfactory( jQuery, window, document );\n\t}\n}(function( $, window, document ) {\n'use strict';\nvar DataTable = $.fn.dataTable;\n\n\n\nvar _link = document.createElement('a');\n\n/**\n * Convert a URL from a relative to an absolute address so it will work\n * correctly in the popup window which has no base URL.\n *\n * @param  {string} href URL\n */\nvar _relToAbs = function (href) {\n\t// Assign to a link on the original page so the browser will do all the\n\t// hard work of figuring out where the file actually is\n\t_link.href = href;\n\tvar linkHost = _link.host;\n\n\t// IE doesn't have a trailing slash on the host\n\t// Chrome has it on the pathname\n\tif (linkHost.indexOf('/') === -1 && _link.pathname.indexOf('/') !== 0) {\n\t\tlinkHost += '/';\n\t}\n\n\treturn _link.protocol + '//' + linkHost + _link.pathname + _link.search;\n};\n\nDataTable.ext.buttons.print = {\n\tclassName: 'buttons-print',\n\n\ttext: function (dt) {\n\t\treturn dt.i18n('buttons.print', 'Print');\n\t},\n\n\taction: function (e, dt, button, config, cb) {\n\t\tvar data = dt.buttons.exportData(\n\t\t\t$.extend({ decodeEntities: false }, config.exportOptions) // XSS protection\n\t\t);\n\t\tvar exportInfo = dt.buttons.exportInfo(config);\n\n\t\t// Get the classes for the columns from the header cells\n\t\tvar columnClasses = dt\n\t\t\t.columns(config.exportOptions.columns)\n\t\t\t.nodes()\n\t\t\t.map(function (n) {\n\t\t\t\treturn n.className;\n\t\t\t})\n\t\t\t.toArray();\n\n\t\tvar addRow = function (d, tag) {\n\t\t\tvar str = '<tr>';\n\n\t\t\tfor (var i = 0, ien = d.length; i < ien; i++) {\n\t\t\t\t// null and undefined aren't useful in the print output\n\t\t\t\tvar dataOut = d[i] === null || d[i] === undefined ? '' : d[i];\n\t\t\t\tvar classAttr = columnClasses[i] ? 'class=\"' + columnClasses[i] + '\"' : '';\n\n\t\t\t\tstr += '<' + tag + ' ' + classAttr + '>' + dataOut + '</' + tag + '>';\n\t\t\t}\n\n\t\t\treturn str + '</tr>';\n\t\t};\n\n\t\t// Construct a table for printing\n\t\tvar html = '<table class=\"' + dt.table().node().className + '\">';\n\n\t\tif (config.header) {\n\t\t\tvar headerRows = data.headerStructure.map(function (row) {\n\t\t\t\treturn (\n\t\t\t\t\t'<tr>' +\n\t\t\t\t\trow\n\t\t\t\t\t\t.map(function (cell) {\n\t\t\t\t\t\t\treturn cell\n\t\t\t\t\t\t\t\t? '<th colspan=\"' +\n\t\t\t\t\t\t\t\t\t\tcell.colspan +\n\t\t\t\t\t\t\t\t\t\t'\" rowspan=\"' +\n\t\t\t\t\t\t\t\t\t\tcell.rowspan +\n\t\t\t\t\t\t\t\t\t\t'\">' +\n\t\t\t\t\t\t\t\t\t\tcell.title +\n\t\t\t\t\t\t\t\t\t\t'</th>'\n\t\t\t\t\t\t\t\t: '';\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.join('') +\n\t\t\t\t\t'</tr>'\n\t\t\t\t);\n\t\t\t});\n\n\t\t\thtml += '<thead>' + headerRows.join('') + '</thead>';\n\t\t}\n\n\t\thtml += '<tbody>';\n\t\tfor (var i = 0, ien = data.body.length; i < ien; i++) {\n\t\t\thtml += addRow(data.body[i], 'td');\n\t\t}\n\t\thtml += '</tbody>';\n\n\t\tif (config.footer && data.footer) {\n\t\t\tvar footerRows = data.footerStructure.map(function (row) {\n\t\t\t\treturn (\n\t\t\t\t\t'<tr>' +\n\t\t\t\t\trow\n\t\t\t\t\t\t.map(function (cell) {\n\t\t\t\t\t\t\treturn cell\n\t\t\t\t\t\t\t\t? '<th colspan=\"' +\n\t\t\t\t\t\t\t\t\t\tcell.colspan +\n\t\t\t\t\t\t\t\t\t\t'\" rowspan=\"' +\n\t\t\t\t\t\t\t\t\t\tcell.rowspan +\n\t\t\t\t\t\t\t\t\t\t'\">' +\n\t\t\t\t\t\t\t\t\t\tcell.title +\n\t\t\t\t\t\t\t\t\t\t'</th>'\n\t\t\t\t\t\t\t\t: '';\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.join('') +\n\t\t\t\t\t'</tr>'\n\t\t\t\t);\n\t\t\t});\n\n\t\t\thtml += '<tfoot>' + footerRows.join('') + '</tfoot>';\n\t\t}\n\t\thtml += '</table>';\n\n\t\t// Open a new window for the printable table\n\t\tvar win = window.open('', '');\n\n\t\tif (!win) {\n\t\t\tdt.buttons.info(\n\t\t\t\tdt.i18n('buttons.printErrorTitle', 'Unable to open print view'),\n\t\t\t\tdt.i18n(\n\t\t\t\t\t'buttons.printErrorMsg',\n\t\t\t\t\t'Please allow popups in your browser for this site to be able to view the print view.'\n\t\t\t\t),\n\t\t\t\t5000\n\t\t\t);\n\n\t\t\treturn;\n\t\t}\n\n\t\twin.document.close();\n\n\t\t// Inject the title and also a copy of the style and link tags from this\n\t\t// document so the table can retain its base styling. This avoids\n\t\t// issues with Content Security Policy (CSP) and is compatible with modern browsers.\n\t\twin.document.title = exportInfo.title;\n\n\t\t$('style, link[rel=\"stylesheet\"]').each(function () {\n\t\t\tlet node = this.cloneNode(true);\n\n\t\t\tif (node.tagName.toLowerCase() === 'link') {\n\t\t\t\tnode.href = _relToAbs(node.href);\n\t\t\t}\n\n\t\t\twin.document.head.appendChild(node);\n\t\t});\n\n\t\t// Add any custom scripts (for example for paged.js)\n\t\tif (config.customScripts) {\n\t\t\tconfig.customScripts.forEach(function (script) {\n\t\t\t\tvar tag = win.document.createElement('script');\n\t\t\t\ttag.src = script;\n\t\t\t\twin.document.getElementsByTagName('head')[0].appendChild(tag);\n\t\t\t});\n\t\t}\n\n\t\t// Inject the table and other surrounding information\n\t\twin.document.body.innerHTML =\n\t\t\t'<h1>' +\n\t\t\texportInfo.title +\n\t\t\t'</h1>' +\n\t\t\t'<div>' +\n\t\t\t(exportInfo.messageTop || '') +\n\t\t\t'</div>' +\n\t\t\thtml +\n\t\t\t'<div>' +\n\t\t\t(exportInfo.messageBottom || '') +\n\t\t\t'</div>';\n\n\t\t$(win.document.body).addClass('dt-print-view');\n\n\t\t$('img', win.document.body).each(function (i, img) {\n\t\t\timg.setAttribute('src', _relToAbs(img.getAttribute('src')));\n\t\t});\n\n\t\tif (config.customize) {\n\t\t\tconfig.customize(win, config, dt);\n\t\t}\n\n\t\t// Allow stylesheets time to load\n\t\tvar autoPrint = function () {\n\t\t\tif (config.autoPrint) {\n\t\t\t\twin.print(); // blocking - so close will not\n\t\t\t\twin.close(); // execute until this is done\n\t\t\t}\n\t\t};\n\n\t\twin.setTimeout(autoPrint, 1000);\n\n\t\tcb();\n\t},\n\n\tasync: 100,\n\n\ttitle: '*',\n\n\tmessageTop: '*',\n\n\tmessageBottom: '*',\n\n\texportOptions: {},\n\n\theader: true,\n\n\tfooter: true,\n\n\tautoPrint: true,\n\n\tcustomize: null\n};\n\n\nreturn DataTable;\n}));\n"],"names":["factory","define","amd","$","window","document","exports","jq","require","cjsRequires","root","fn","dataTable","Buttons","module","jQuery","DataTable","_link","createElement","_relToAbs","href","linkHost","host","indexOf","pathname","protocol","search","ext","buttons","print","className","text","dt","i18n","action","e","button","config","cb","data","exportData","extend","decodeEntities","exportOptions","exportInfo","columnClasses","columns","nodes","map","n","toArray","addRow","d","tag","str","i","ien","length","dataOut","undefined","html","table","node","header","headerStructure","row","cell","colspan","rowspan","title","join","body","footer","footerStructure","win","open","close","each","this","cloneNode","tagName","toLowerCase","head","appendChild","customScripts","forEach","script","src","getElementsByTagName","innerHTML","messageTop","messageBottom","addClass","img","setAttribute","getAttribute","customize","setTimeout","autoPrint","info","async"],"mappings":"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"}